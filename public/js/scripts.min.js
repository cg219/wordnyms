$.material.init(),angular.module("WordNyms",["ngRoute","ngResource","ngAudio"]).config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode(!0),a.when("/",{templateUrl:"home.html",controller:"Main"}).when("/game/solo/:player/:round",{templateUrl:"single.html",controller:"SingleGame"}).when("/results/solo/round/:player/:round",{templateUrl:"round.html",controller:"RoundRecap"}).when("/results/solo/final/:player",{templateUrl:"final.html",controller:"FinalStats"})}]).factory("Word",["$resource",function(a){return a("/api/nyms/:word")}]).factory("WordList",["$resource",function(a){return a("/api/nyms/getList/:level")}]).factory("Player",function(){return{name:"",score:0,roundScore:0,correct:0,streak:0,roundStreak:0,highestStreak:0,allGuesses:[],currentWordInfo:{},currentCorrectAnswers:[],gameLevel:1,resetStats:function(){this.score=0,this.roundScore=0,this.correct=0,this.streak=0,this.roundStreak=0,this.highestStreak=0,this.allGuesses=[],this.currentWordInfo={},this.currentCorrectAnswers=[]}}}).directive("kmEnter",function(){return{restrict:"A",link:function(a,b,c){b.bind("keypress",function(b){13==b.which&&a.$eval(c.kmEnter)})}}}).controller("Main",["$scope","$location","Player","ngAudio",function(a,b,c){var d=function(){var b=!0;return(""==a.playerName||void 0==a.playerName)&&(b=!1),(""==a.playerAge||void 0==a.playerAge)&&(b=!1),b};a.chosenLevel=1,a.updateName=function(){c.name=a.playerName},a.playSingle=function(){d()?(c.gameLevel=a.chosenLevel,b.path("/game/solo/"+c.name+"/1")):alert("Please fill out Age and Name")}}]).controller("SingleGame",["$scope","$resource","WordList","Word","$interval","$location","Player","$routeParams",function(a,b,c,d,e,f,g,h){var i,j,k;a.checkingGuess=!1,a.roundNumber=h.round,a.timer=60,a.guesses=[],a.score=0,i=g.gameLevel,g.roundStreak=0,g.roundScore=0,g.correct=0,k=c.get({level:i},function(){l()}),j=e(function(){a.timer<=0&&(e.cancel(j),g.score+=g.roundScore,g.highestStreak=g.roundStreak>g.highestStreak?g.roundStreak:g.highestStreak,a.checkingGuess||n()),a.timer-=1},1e3),a.$watch("antonyms",function(){a.antonymsLeft=a.antonyms?a.antonyms.length:0}),a.$watch("synonyms",function(){a.synonymsLeft=a.synonyms?a.synonyms.length:0}),a.$watch("checkingGuess",function(){a.timer<=0&&(a.checkingGuess||n())});var l=function(){console.log("Getting Random Word"),d.get({word:k.words[_.random(k.words.length)]},function(b){if(!b.type)return void a.nextWord();a.currentWordType=b.type,a.currentWord=b.word.name,a.antonyms=b.word.antonyms[b.type],a.synonyms=b.word.synonyms[b.type];var c={antonyms:b.word.antonyms[b.type],synonyms:b.word.synonyms[b.type],word:b.word.name,type:b.type};g.currentWordInfo=c,g.currentCorrectAnswers=[]})},m=function(){g.streak++;var b=a.roundNumber,c=g.streak>=3?10*(g.streak-2):0,d=10*i;g.roundStreak=g.streak>g.roundStreak?g.streak:g.roundStreak,g.roundScore+=d*b+c,g.correct++,a.score=g.roundScore},n=function(){f.path(3==a.roundNumber?"/results/solo/final/"+g.name:"/results/solo/round/"+g.name+"/"+a.roundNumber)};a.nextWord=function(b){g.allGuesses.push({name:g.currentWordInfo.word,type:g.currentWordInfo.type,synonyms:g.currentWordInfo.synonyms,antonyms:g.currentWordInfo.antonyms,correct:g.currentCorrectAnswers,round:a.roundNumber}),a.guesses=[],k.words=_.without(k.words,b),l()},a.guess=function(){var b=a.playerGuess.toLowerCase();a.checkingGuess=!0,_.contains(a.antonyms,b)?(a.antonyms=_.without(a.antonyms,b),m(),a.checkingGuess=!1,g.currentCorrectAnswers.push(b),a.guesses.push({word:b,"class":"info"})):_.contains(a.synonyms,b)?(a.synonyms=_.without(a.synonyms,b),m(),a.checkingGuess=!1,g.currentCorrectAnswers.push(b),a.guesses.push({word:b,"class":"info"})):(a.timer-=2,g.streak=0,a.checkingGuess=!1,a.guesses.push({word:b,"class":"danger"})),a.synonymsLeft<=0&&a.antonymsLeft<=0&&a.nextWord(a.currentWord),a.playerGuess=""}}]).controller("RoundRecap",["$scope","$resource","Player","$interval","$location","$routeParams",function(a,b,c,d,e,f){a.player=c,a.timer=15,a.roundNumber=f.round;var g=d(function(){a.timer-=1,a.timer<=0&&(d.cancel(g),e.path("/game/solo/"+c.name+"/"+ ++f.round))},1e3)}]).controller("FinalStats",["$scope","$resource","Player","$interval","$location",function(a,b,c,d,e){a.player=c,a.playAgain=function(){c.resetStats(),e.path("/game/solo/"+c.name+"/1")}}]);